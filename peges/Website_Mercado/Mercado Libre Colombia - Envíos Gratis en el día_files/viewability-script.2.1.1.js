var frontend_viewability;!function(){"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t);class s{constructor(e,t){this.name=e,this.version=t}}const i="NONE",n="DIRECT",r="sessionStart",o="sessionFinish",a="full",c="definedByJavaScript",h="htmlDisplay",d="definedByJavaScript",l="beginToRender",u="generic";class p{constructor(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;this.resourceUrl=e,this.vendorKey=t,this.verificationParameters=s,this.accessMode=i}serialize(){return{accessMode:this.accessMode,resourceUrl:this.resourceUrl,vendorKey:this.vendorKey,verificationParameters:this.verificationParameters}}}var m=class{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.partner=e,this.verificationScriptResources=t,this.slotElement=null,this.contentUrl=s,this.customReferenceData=i,this.underEvaluation=!1,this.serviceWindow=null}setSlotElement(e){this.slotElement=e}setServiceWindow(e){this.serviceWindow=e}};const _="omid_message_guid",v="omid_message_method",f="omid_message_version",g="omid_message_args";class w{static deserialize(e){return new w(e[_],e[v],e[f],e[g])}constructor(e,t,s,i){this.guid=e,this.method=t,this.version=s,this.args=i}serialize(){const e={[_]:this.guid,[v]:this.method,[f]:this.version};return void 0!==this.args&&(e[g]=this.args),e}}var y=w;var E=class{constructor(e){this.to=e,this.communicationType_=i}handleMessage(e,t){this.onMessage&&this.onMessage(e,t)}serialize(e){return JSON.stringify(e)}deserialize(e){try{return JSON.parse(e)}catch(e){return{}}}isDirectCommunication(){return this.communicationType_===n}};class S extends E{constructor(e){super(e),this.communicationType_=n,this.handleExportedMessage=S.prototype.handleExportedMessage.bind(this)}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.to;if(!t)throw new Error("Message destination must be defined at construction time or when sending the message.");t.handleExportedMessage(e.serialize(),this)}handleExportedMessage(e,t){this.handleMessage(y.deserialize(e),t)}isCrossOrigin(){return!1}}var T=S;let M;M=(()=>{if(void 0!==M&&M)return M;if(void 0!==e.g&&e.g)return e.g;if("undefined"!=typeof window&&window)return window;if("undefined"!=typeof globalThis&&globalThis)return globalThis;const t=Function("return this")();if(t)return t;throw new Error("Could not determine global object context.")})();var R={omidGlobal:M};const b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null!=e&&void 0!==e.top&&null!=e.top},{omidGlobal:I}=R,x=e=>{if(e===I)return!1;try{if(void 0===e.location.hostname)return!0}catch(e){return!0}return!1},O=["omid","v1_SessionServiceCommunication"];function C(e,t){return t.reduce(((e,t)=>e&&e[t]),e)}function U(e,t){if(!x(e)){const s=C(e,t);if(s)return new T(s)}return null}function A(e,t){for(let s=0;s<e.length;s+=1){const i=U(e[s],t);if(i)return i}return null}function N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>(e=>{const t=16*Math.random()|0;return e?(3&t|8).toString(16):t.toString(16)})("y"===e)))}const L="SessionService.",k=(e,t)=>t+e,D=e=>/\d+\.\d+\.\d+(-.*)?/.test(e),P=(e,t)=>{const s=e.split("-")[0].split("."),i=t.split("-")[0].split(".");for(let e=0;e<3;e+=1){const t=parseInt(s[e],10),n=parseInt(i[e],10);if(t>n)return!0;if(t<n)return!1}return!0},W="1.0.3";const{omidGlobal:V}=R,K="omidSessionInterface",j="adEvents",z={sessionError:"reportError"},F=["impressionOccurred"];var J=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;this.interfaceRoot_=e[K]}isSupported(){return null!=this.interfaceRoot_}sendMessage(e,t,s){let i=e,n=this.interfaceRoot_;const r="registerSessionObserver"===i?[t]:s;if(i in z&&(i=z[i]),F.includes(i)&&(n=n[j]),!n[i])throw new Error("Unrecognized method name: ".concat(i,"."));n[i](...r)}};const B="1.3.37-dev";class G{constructor(e,t,s){this.impressionOccurred_=!1,this.hasAdEvents_=!1,this.hasMediaEvents_=!1,this.isSessionRunning_=!1,this.creativeType_=null,this.callbackMap_={},this.impressionType_=null,this.creativeLoaded_=!1,this.context_=e;const i=this.context_.serviceWindow||void 0;this.communication_=t||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const s=[e,(i=e,b(i)?i.top:I)];var i;return t&&s.unshift(t),A(s,O)}((e=>{let t=e;return void 0===e&&"undefined"!=typeof window&&window&&(t=window),b(t)?t:I})(),i),this.sessionInterface_=s||new J,this.communication_&&(this.communication_.onMessage=this.handleInternalMessage_.bind(this)),this.setClientInfo_(),this.injectVerificationScripts_(e.verificationScriptResources),e.slotElement&&this.sendSlotElement_(e.slotElement),this.sendContentUrl_(e.contentUrl),this.watchSessionEvents_()}setCreativeType(e){if(e===c)throw new Error("Creative type cannot be redefined with value ".concat(c));if(this.impressionOccurred_)throw new Error("Impression has already occurred");if(this.creativeLoaded_)throw new Error("Creative has already loaded");if(this.creativeType_&&this.creativeType_!==c)throw new Error("Creative type cannot be redefined");if(void 0===this.creativeType_)throw new Error("Native integration is using OMID 1.2 or earlier");this.sendOneWayMessage("setCreativeType",e),this.creativeType_=e}setImpressionType(e){if(e===d)throw new Error("Impression type cannot be redefined with value ".concat(d));if(this.impressionOccurred_)throw new Error("Impression has already occurred");if(this.creativeLoaded_)throw new Error("Creative has already loaded");if(this.impressionType_&&this.impressionType_!==d)throw new Error("Impression type cannot be redefined");if(void 0===this.impressionType_)throw new Error("Native integration is using OMID 1.2 or earlier");this.sendOneWayMessage("setImpressionType",e),this.impressionType_=e}isSupported(){return Boolean(this.communication_)||this.sessionInterface_.isSupported()}isSendingElementsSupported_(){return this.communication_?this.communication_.isDirectCommunication():this.sessionInterface_.isSupported()}registerSessionObserver(e){this.sendMessage("registerSessionObserver",e)}start(){const e={customReferenceData:this.context_.customReferenceData,underEvaluation:this.context_.underEvaluation};this.sendOneWayMessage("startSession",e)}finish(){this.sendOneWayMessage("finishSession")}error(e,t){this.sendOneWayMessage("sessionError",e,t)}registerAdEvents(){if(this.hasAdEvents_)throw new Error("AdEvents already registered.");this.hasAdEvents_=!0,this.sendOneWayMessage("registerAdEvents")}sendOneWayMessage(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];this.sendMessage(e,null,...s)}sendMessage(e,t){for(var s=arguments.length,i=new Array(s>2?s-2:0),n=2;n<s;n++)i[n-2]=arguments[n];this.communication_?this.sendInternalMessage_(e,t,i):this.sessionInterface_.isSupported()&&this.sendInterfaceMessage_(e,t,i)}sendInternalMessage_(e,t,s){const i=N(),n=new y(i,k(e,L),B,function(e,t){return D(e)&&P(e,W)?t:JSON.stringify(t)}(B,s));t&&(this.callbackMap_[i]=t),this.communication_&&this.communication_.sendMessage(n)}handleInternalMessage_(e,t){const{method:s,guid:i,args:n}=e;if("response"===s&&this.callbackMap_[i]){const e=function(e,t){return D(e)&&P(e,W)?t||[]:t?JSON.parse(t):[]}(B,n);this.callbackMap_[i].apply(this,e)}}sendInterfaceMessage_(e,t,s){try{this.sessionInterface_.sendMessage(e,t,s)}catch(e){console.log("Failed to communicate with SessionInterface with error:",e)}}assertSessionRunning(){if(!this.isSessionRunning_)throw new Error("Session not started.")}impressionOccurred(){if(this.creativeType_===c)throw new Error("Creative type has not been redefined");if(this.impressionType_===d)throw new Error("Impression type has not been redefined");this.impressionOccurred_=!0}creativeLoaded(){if(this.creativeType_===c)throw new Error("Creative type has not been redefined");if(this.impressionType_===d)throw new Error("Impression type has not been redefined");this.creativeLoaded_=!0}setClientInfo_(){this.sendOneWayMessage("setClientInfo",B,this.context_.partner.name,this.context_.partner.version)}injectVerificationScripts_(e){if(!e)return;const t=e.map((e=>e.serialize()));this.sendOneWayMessage("injectVerificationScriptResources",t)}sendSlotElement_(e){this.sendElement_(e,"setSlotElement")}sendElement_(e,t){this.isSendingElementsSupported_()?this.sendOneWayMessage(t,e):this.error(u,"Session Client ".concat(t," called when communication is cross-origin"))}sendContentUrl_(e){e&&this.sendOneWayMessage("setContentUrl",e)}setElementBounds(e){this.sendOneWayMessage("setElementBounds",e)}watchSessionEvents_(){this.registerSessionObserver((e=>{e.type===r&&(this.isSessionRunning_=!0,this.creativeType_=e.data.creativeType,this.impressionType_=e.data.impressionType),e.type===o&&(this.isSessionRunning_=!1)}))}}class Y{constructor(e){try{e.registerAdEvents(),this.adSession=e}catch(e){throw new Error("AdSession already has an ad events instance registered")}}impressionOccurred(){this.adSession.assertSessionRunning(),this.adSession.impressionOccurred(),this.adSession.sendOneWayMessage("impressionOccurred")}loaded(){this.adSession.sendOneWayMessage("loaded")}}class q{constructor(e,t,i,n){var r=this;this.MEASUREMENT_SCRIPT_URL="",this.VENDOR_KEY="mercadolibre",this.VERIFICATIONS_PARAMETER="",this.SDK_URL="",this._session=null,this._meliVaTrackUrl="",this._adEvents=null,this.setMeliVaTrackUrl=e=>{this._meliVaTrackUrl=e},this.start=e=>{if(this._meliVaTrackUrl&&""!==this._meliVaTrackUrl){const t=this.createOmsdkIframe();t.addEventListener("load",this.omsdkIframeDidLoad(t,e)),document.body.appendChild(t)}},this.impressionOccurred=()=>{var e;null===(e=this._adEvents)||void 0===e||e.impressionOccurred()},this.finishSession=()=>{var e;null===(e=this._session)||void 0===e||e.finish()},this.isValidNonce=e=>"string"==typeof e&&e.length>0,this.createOmsdkIframe=()=>{const e=document.createElement("iframe");e.style.display="none";const t=window.viewability.getNonceToken(),s=this.isValidNonce(t),i="<script nonce='".concat(window.viewability.getNonceToken(),"'>\n      window.nonce='").concat(window.viewability.getNonceToken(),"'\n    <\/script>"),n="<script defer ".concat(s?"nonce='".concat(window.viewability.getNonceToken(),"'"):"","\n      src='").concat(this.SDK_URL,"'>\n    <\/script>");return e.srcdoc=s?i+n:n,e},this.omsdkIframeDidLoad=(e,t)=>()=>{this._session=this.createAdSession(e)(t,this._meliVaTrackUrl),this._session.setCreativeType(h),this._session.setImpressionType(l),this._session.registerSessionObserver((function(e){return r._sessionObserverCallback(e)})),this._adEvents=new Y(this._session),this._session.start()},this.getVerificationResources=()=>[new p(this.MEASUREMENT_SCRIPT_URL,this.VENDOR_KEY,this.VERIFICATIONS_PARAMETER),...this._thirdPartyResources.map((e=>new p(e.url,e.vendor,e.verification_parameters)))],this.createAdSession=e=>(t,i)=>{const n=new s("Referenceapp","0.0.0"),r=new m(n,this.getVerificationResources(),i,this._customReferenceData);r.underEvaluation=!1,r.setSlotElement(t);const o=e.contentWindow;if(!o)throw new Error("OM SDK iframe content window not available.");return r.setServiceWindow(o),new G(r)},this.SDK_URL=e,this.MEASUREMENT_SCRIPT_URL=t,this._thirdPartyResources=i,this._customReferenceData=n}_sessionObserverCallback(e){"sessionStart"===e.type&&this.impressionOccurred()}}window.viewability=new class{constructor(e,t){var s=this;this.STATIC_URL="https://http2.mlstatic.com/frontend-assets/frontend-viewability",this.SDK_URL="",this.SDK_NAME="omweb-v3.js",this.MEASUREMENT_SCRIPT_URL="measurement-script.js",this.VENDOR_KEY="mercadolibre",this.VERIFICATIONS_PARAMETER="",this.nonceToken="",this.getCookie=e=>document.cookie.split(";").reduce(((t,s)=>s.trim().startsWith(e)?t+s.replace("".concat(e,"="),"").trim():t),""),this.hasPixelTag=e=>e.pixel_tag&&"string"==typeof e.pixel_tag&&""!==e.pixel_tag.trim(),this.addSession=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new q(s.SDK_URL,s.MEASUREMENT_SCRIPT_URL,e.filter((e=>!s.hasPixelTag(e))),t)},this.setNonceForCSP=e=>{this.nonceToken=e;const t=new Event("viewability-enabled",{bubbles:!0,composed:!0});window.dispatchEvent(t)},this.getNonceToken=()=>this.nonceToken,this.setTag=(e,t)=>{try{const s=e.filter((e=>this.hasPixelTag(e)));if(!t&&s.length>0||!(t instanceof HTMLElement))return;s.forEach((e=>{let{pixel_tag:s}=e;const i=(new DOMParser).parseFromString(s,"text/html");i.body.querySelector("parsererror")||Array.from(i.body.childNodes[0].childNodes).forEach((e=>{if("script"===e.nodeName.toLowerCase()){const s=e,i=document.createElement("script");s.src?(i.src=s.src,i.type=s.type||"application/javascript",i.async=s.async):i.text=s.textContent||"",t.appendChild(i)}else t.appendChild(e.cloneNode(!0))}))}))}catch(e){this.getCookie("va-debug")&&console.log("error on set tag: ",e)}},this.version="1.0.0",this.SDK_URL="".concat(this.STATIC_URL,"/").concat(this.SDK_NAME),this.MEASUREMENT_SCRIPT_URL="".concat(this.STATIC_URL,"/measurement-script.js");const i=this.getCookie("measurement-version")||"";""!==i&&(this.MEASUREMENT_SCRIPT_URL="".concat(this.STATIC_URL,"/measurement-script.").concat(i,".js")),e&&(this.SDK_URL=e),t&&(this.MEASUREMENT_SCRIPT_URL=t)}};const H=new Event("viewability-loaded",{bubbles:!0,composed:!0});window.dispatchEvent(H),frontend_viewability=t}();