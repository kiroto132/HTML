var frontend_viewability;!function(){"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};let i;e.r(t);i=(()=>{if(void 0!==i&&i)return i;if(void 0!==e.g&&e.g)return e.g;if("undefined"!=typeof window&&window)return window;if("undefined"!=typeof globalThis&&globalThis)return globalThis;const t=Function("return this")();if(t)return t;throw new Error("Could not determine global object context.")})();var s={omidGlobal:i};const n="NONE",r="DIRECT",o={IMPRESSION:"impression",LOADED:"loaded",GEOMETRY_CHANGE:"geometryChange",SESSION_START:"sessionStart",SESSION_ERROR:"sessionError",SESSION_FINISH:"sessionFinish"};var a=class{constructor(e){this.to=e,this.communicationType_=n}handleMessage(e,t){this.onMessage&&this.onMessage(e,t)}serialize(e){return JSON.stringify(e)}deserialize(e){try{return JSON.parse(e)}catch(e){return{}}}isDirectCommunication(){return this.communicationType_===r}};const c="omid_message_guid",d="omid_message_method",h="omid_message_version",l="omid_message_args";class u{static deserialize(e){return new u(e[c],e[d],e[h],e[l])}constructor(e,t,i,s){this.guid=e,this.method=t,this.version=i,this.args=s}serialize(){const e={[c]:this.guid,[d]:this.method,[h]:this.version};return void 0!==this.args&&(e[l]=this.args),e}}var m=u;class g extends a{constructor(e){super(e),this.communicationType_=r,this.handleExportedMessage=g.prototype.handleExportedMessage.bind(this)}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.to;if(!t)throw new Error("Message destination must be defined at construction time or when sending the message.");t.handleExportedMessage(e.serialize(),this)}handleExportedMessage(e,t){this.handleMessage(m.deserialize(e),t)}isCrossOrigin(){return!1}}var f=g;const v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null!=e&&void 0!==e.top&&null!=e.top},{omidGlobal:p}=s,_=e=>{if(e===p)return!1;try{if(void 0===e.location.hostname)return!0}catch(e){return!0}return!1},y=["omid","v1_VerificationServiceCommunication"],S=["omidVerificationProperties","serviceWindow"];function b(e,t){return t.reduce(((e,t)=>e&&e[t]),e)}function w(e,t){if(!_(e)){const i=b(e,t);if(i)return new f(i)}return null}function x(e,t){for(let i=0;i<e.length;i+=1){const s=w(e[i],t);if(s)return s}return null}function E(e){const t=[],i=b(e,S);var s;return i&&t.push(i),t.push(v(s=e)?s.top:p),x(t,y)}const T=e=>/\d+\.\d+\.\d+(-.*)?/.test(e),M=(e,t)=>{const i=e.split("-")[0].split("."),s=t.split("-")[0].split(".");for(let e=0;e<3;e+=1){const t=parseInt(i[e],10),n=parseInt(s[e],10);if(t>n)return!0;if(t<n)return!1}return!0},O="1.0.3";function C(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>(e=>{const t=16*Math.random()|0;return e?(3&t|8).toString(16):t.toString(16)})("y"===e)))}const I="VerificationService.",L=(e,t)=>t+e,N="1.3.37-dev",{omidGlobal:k}=s;new class{constructor(e,t){this.customReferenceData="",this.DefaultLogServer="",this.timeoutHandle=null,this.sent=!1,this.verificationClient_=e;this.verificationClient_.isSupported()&&(this.verificationClient_.registerSessionObserver((e=>this.sessionObserverCallback_(e)),t),Object.keys(o).forEach((e=>this.verificationClient_.addEventListener(o[e],(e=>this.omidEventListenerCallback_(e))))))}isImpressionEvent(e){return"impression"===e.type}isGeometryEvent(e){return"geometryChange"===e.type}isOver50Percent(e){return e.data.adView.percentageInView>=50}startTimeCheck(e){this.timeoutHandle||(this.timeoutHandle=this.verificationClient_.setTimeout(e,1e3))}invalidateTimer(){this.timeoutHandle&&(this.verificationClient_.clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}sendImpressionEvent(e){this.isImpressionEvent(e)&&this.verificationClient_.sendUrl(this.customReferenceData)}sendViewabilityEvent(e){if(this.isGeometryEvent(e)){if(this.isOver50Percent(e))return void this.startTimeCheck((()=>{this.sent||(this.sendPrint_(),this.sent=!0)}));this.invalidateTimer()}}setLogServer(e){this.DefaultLogServer=e.data.contentUrl,e.data.context&&(this.customReferenceData=e.data.context.customReferenceData)}sendPrint_(){const e=this.DefaultLogServer;let t=[];try{if(t=JSON.parse(sessionStorage.getItem("advertising-view-mem")||"[]"),t.includes(e))return}catch(e){console.log("error getting from storage: ",e)}this.verificationClient_.sendUrl(e);try{sessionStorage.setItem("advertising-view-mem",JSON.stringify([...t.slice(-19),e]))}catch(e){console.log("error saving from storage: ",e)}}sessionObserverCallback_(e){"sessionStart"===e.type&&this.setLogServer(e)}omidEventListenerCallback_(e){this.sendImpressionEvent(e),this.sendViewabilityEvent(e)}}(new class{constructor(e){this.callbackMap_={},this.imgCache_=[],this.remoteTimeouts_=0,this.communication=e||E((e=>{let t=e;return void 0===e&&"undefined"!=typeof window&&window&&(t=window),v(t)?t:p})()),this.communication&&(this.communication.onMessage=this.handleMessage_.bind(this));const t=k.omidVerificationProperties;this.injectionId_=t?t.injectionId:void 0}isSupported(){return!!this.communication}registerSessionObserver(e,t){this.sendMessage_("addSessionListener",e,t,this.injectionId_)}addEventListener(e,t){this.sendMessage_("addEventListener",t,e)}sendUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};k.document?this.sendUrlWithImg_(e,t,i):this.sendMessage_("sendUrl",(e=>{e&&t?t():!e&&i&&i()}),e)}sendUrlWithImg_(e,t,i){const s=k.document.createElement("img");this.imgCache_.push(s);const n=e=>{const t=this.imgCache_.indexOf(s);t>=0&&this.imgCache_.splice(t,1),e&&e()};s.addEventListener("load",(()=>n(t))),s.addEventListener("error",(()=>n(i))),s.src=e}sendMessage_(e,t){if(!this.communication)return;const i=C();t&&(this.callbackMap_[i]=t);for(var s=arguments.length,n=new Array(s>2?s-2:0),r=2;r<s;r++)n[r-2]=arguments[r];const o=new m(i,L(e,I),N,function(e,t){return T(e)&&M(e,O)?t:JSON.stringify(t)}(N,n));this.communication.sendMessage(o)}handleMessage_(e,t){const{method:i,guid:s,args:n}=e;if("response"===i&&this.callbackMap_[s]){const e=function(e,t){return T(e)&&M(e,O)?t||[]:t?JSON.parse(t):[]}(N,n);this.callbackMap_[s].apply(this,e)}}hasTimeoutMethods_(){return"function"==typeof k.setTimeout&&"function"==typeof k.clearTimeout}setTimeout(e,t){if(t<=0)return-1;if(this.hasTimeoutMethods_()){const i=k.setTimeout(e,t);if("number"==typeof i)return i;throw new Error("setTimeout return invalid type.")}this.remoteTimeouts_+=1;const i=this.remoteTimeouts_;return this.sendMessage_("setTimeout",e,i,t),i}clearTimeout(e){e<=0||(this.hasTimeoutMethods_()?k.clearTimeout(e):this.sendOneWayMessage_("clearTimeout",e))}sendOneWayMessage_(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.sendMessage_(e,(()=>null),...i)}},"iabtechlab.com-omid"),frontend_viewability=t}();